<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="cz">
    <resultMap class="java.util.HashMap" id="queryStationResult">
        <result property="NET_CODE" column="NET_CODE" javaType="String"/>
        <result property="STA_CODE" column="STA_CODE" javaType="String"/>
        <result property="STA_CNAME" column="STA_CNAME" javaType="String"/>
        <result property="ROCK_TYPE" column="ROCK_TYPE" javaType="String"/>
        <result property="INSTRUMENT_ID" column="INSTRUMENT_ID" javaType="String"/>
        <result property="DATARECORD_ID" column="DATARECORD_ID" javaType="String"/>
        <result property="instrModel" column="insModel" javaType="String"/>
        <result property="dasModel" column="dasModel" javaType="String"/>
        <result property="STA_LAT" column="STA_LAT" javaType="Double"/>
        <result property="STA_LON" column="STA_LON" javaType="Double"/>
        <result property="STA_ELEV" column="STA_ELEV" javaType="Double"/>
    </resultMap>
    <resultMap class="java.util.HashMap" id="queryInstrResult">
    	<result property="ID" column="ID" javaType="String"/>
        <result property="INSTR_TYPE" column="INSTR_TYPE" javaType="String"/>
        <result property="INSTR_MODEL" column="INSTR_MODEL" javaType="String"/>
    </resultMap>
    <!-- 查询测震台站数据 -->
	<select id="queryStation" parameterClass="datashare.seismic.station.model.Criteria"
                        resultMap="queryStationResult">
		<![CDATA[
		SELECT NET_CODE,STA_CODE,STA_CNAME,ROCK_TYPE,INSTRUMENT_ID,DATARECORD_ID,INS.INSTR_MODEL as insModel,INS2.INSTR_MODEL as dasModel,
			   STA_LAT,STA_LON,STA_ELEV
		FROM $schema$.Station_info ST, $schema$.Instr_dic INS, $schema$.Instr_dic INS2
		WHERE ST.INSTRUMENT_ID = INS.ID AND ST.DATARECORD_ID = INS2.ID
		]]>
		<dynamic>
		    <!-- 加入台网查询条件 BY Sam 20090707 -->
		    <isNotEmpty prepend="AND" property="netCode">
		       <![CDATA[(NET_CODE=#netCode#)]]>
		    </isNotEmpty>
		    <isNotEmpty prepend="AND" property="instrumentId">
		       <![CDATA[(INSTRUMENT_ID=#instrumentId#)]]>
		    </isNotEmpty>
		    <isNotEmpty prepend="AND" property="datarecordId">
		       <![CDATA[(DATARECORD_ID=#datarecordId#)]]>
		    </isNotEmpty>
		    <isNotEmpty property="startTimeOfTheYear">
		        <isNotEmpty property="endTimeOfTheYear">
		           <![CDATA[
		           AND((ONDATE>=#startTimeOfTheYear#) AND (ONDATE<=#endTimeOfTheYear#))
		           ]]>
		        </isNotEmpty>
		    </isNotEmpty>
		</dynamic>
	</select>
	<!-- 测震仪器选择列表查询 MySQL-->
	<select id="queryInstrumentMySQL" parameterClass="datashare.seismic.station.model.InstrDic"
			resultMap="queryInstrResult">
		<![CDATA[
		SELECT ID,INSTR_TYPE,INSTR_MODEL
		FROM $schema$.Instr_dic 
		WHERE length(INSTR_TYPE) = length(#instrType#)
		]]>
	</select>
	<!-- 测震仪器选择列表查询 ORACLE-->
	<select id="queryInstrumentOracle" parameterClass="datashare.seismic.station.model.InstrDic"
			resultMap="queryInstrResult">
		<![CDATA[
		SELECT ID,INSTR_TYPE,INSTR_MODEL
		FROM $schema$.Instr_dic 
		WHERE length(INSTR_TYPE) = #typeLen#
		]]>
	</select>
	
	<!--查询台网代码 20090707 By SAM-->
	<select id="queryNetCode" parameterClass="datashare.seismic.station.model.Criteria"
		resultClass="java.lang.String">
		<![CDATA[
		SELECT DISTINCT NET_CODE FROM $schema$.Station_info
		]]>
	</select>
</sqlMap>